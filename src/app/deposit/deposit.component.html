<div class="container mt-5">
  <div class="alert alert-dark alert-dismissible fade show p-4" role="alert">

    <h6 class="text-uppercase text-muted">
      Get started (<span class="text-white">1 of 3</span> complete)
    </h6>
    <p class="lead"><strong>Let's get you set up.</strong> Follow the steps below to leverage the full potential of 88mph.</p>
    <div class="row">
      <div class="col-12 col-lg-4 mb-4">
        <div class="row">
          <div class="col-auto">
            <div class="avatar avatar-xs">
              <span class="avatar-title rounded-circle bg-success text-dark">1</span>
            </div>
          </div>
          <div class="col">
            <p><strong>Deposit</strong> a crypto or stablecoin below to start earning fixed-interest rates and MPH rewards.</p>
            <!-- Button -->
            <button type="button" class="btn btn-sm btn-dark" (click)="openDepositModal()" [disabled]="wallet.watching">
              <i class="fe fe-arrow-down mr-2 align-bottom"></i>Deposit
            </button>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-4 mb-4">
        <div class="row">
          <div class="col-auto">
            <div class="avatar avatar-xs">
              <span class="avatar-title rounded-circle border-gradient bg-light">2</span>
            </div>
          </div>
          <div class="col">
            <p><strong>Claim</strong> you first MPH rewards linked to each of your deposit.</p>
          </div>

        </div>
      </div>

      <div class="col-12 col-lg-4">
        <div class="row">
          <div class="col-auto">
            <div class="avatar avatar-xs">
              <span class="avatar-title rounded-circle border-gradient bg-light">3</span>
            </div>
          </div>
          <div class="col">
            <p><strong>Stake</strong> your MPH rewards to get your protocol earnings share.</p>
            <!-- Button -->
            <button type="button" class="btn btn-sm btn-dark">
              <i class="fe fe-arrow-down mr-2 align-bottom"></i>Stake
            </button>
          </div>
        </div>
      </div>
    </div>

    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true"><i class="fe fe-x text-muted"></i></span>
    </button>
  </div>
  <!--desktop user's data-->
  <div class="card-deck d-none d-lg-flex my-5">
    <div class="card mb-5 mb-lg-0">
      <div class="card-body">
        <!-- Title -->
        <h5 class="text-uppercase">
          Deposits balance
        </h5>

        <!-- Heading -->
        <h2 class="mb-3 glowing">
          ${{totalDepositUSD.toFormat(DECIMALS)}}
        </h2>
        <!-- Button -->
        <button type="button" class="btn btn-sm btn-bg-gradient" (click)="openDepositModal()" [disabled]="wallet.watching">
          <i class="fe fe-arrow-down mr-2 align-bottom"></i>Deposit
        </button>
      </div>
    </div>

    <div class="card mb-5 mb-lg-0">
      <div class="card-body">
        <!-- Title -->
        <h5 class="text-uppercase">
          Interest earned
        </h5>

        <!-- Heading -->
        <h2 class="mb-0 glowing">
          ${{totalInterestUSD.toFormat(DECIMALS)}}
        </h2>
      </div>
    </div>
    <div class="card mb-4 mb-lg-0">
      <div class="card-body">
        <!-- Title -->
        <h5 class="text-uppercase">
          Claimable rewards
        </h5>
        <!-- Heading -->
        <h2 class="mb-1 glowing">
          {{totalMPHEarned.toFormat(DECIMALS)}} MPH
        </h2>
        <h5 class="mb-3 text-white">${{totalMPHEarned.times(mphPriceUSD).toFormat(DECIMALS)}}</h5>
      </div>
    </div>
  </div>
  <!--mobile user's data-->
  <div class="row d-lg-none my-5">
    <div class="col-6">
      <!-- Title -->
      <h5 class="text-uppercase">
        Deposits balance
      </h5>
      <!-- Heading -->
      <h2 class="mb-4 glowing">
        ${{totalDepositUSD.toFormat(DECIMALS)}}
      </h2>
      <!-- Title -->
      <h5 class="text-uppercase">
        Interest earned
      </h5>

      <!-- Heading -->
      <h2 class="mb-0 glowing">
        ${{totalInterestUSD.toFormat(DECIMALS)}}
      </h2>
    </div>
    <div class="col-6">
      <!-- Title -->
      <h5 class="text-uppercase">
        Claimable rewards
      </h5>
      <!-- Heading -->
      <h2 class="mb-1 glowing">
        {{totalMPHEarned.toFormat(DECIMALS)}} MPH
      </h2>
      <h5 class="mb-3 text-muted">${{totalMPHEarned.times(mphPriceUSD).toFormat(DECIMALS)}}</h5>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <!-- Explore fixed rate opportunities -->
      <div class="card mb-6" id="fixedRateOpportunities">
        <div class="card-header">
          <h4 class="card-header-title mr-auto">Fixed-interest rate opportunities</h4>
          <button class="btn btn-sm btn-dark" type="button" data-toggle="collapse" data-target=".multi-collapse" aria-expanded="false" aria-controls="multiCollapseaDAI multiCollapseaUSDC">Toggle all</button>
        </div>
        <div class="table-responsive mb-0">
          <table class="table table-hover table-sm table-nowrap card-table">
            <thead>
              <tr>
                <th>
                  Pool
                </th>
                <th>
                  Your balance
                </th>
                <th>
                  Fixed APY / MPH rewards
                </th>
                <th></th>
              </tr>
            </thead>
            <tbody class="list">
              <!-- Pool rows -->
              <ng-container *ngFor="let pool of allPoolList">
                <tr>
                  <td>
                    <div class="d-flex align-items-center">

                      <!-- Image -->
                      <div class="avatar avatar-xs">
                        <img class="avatar-img rounded-circle mr-3" src={{pool.iconPath}} alt="...">
                      </div>

                      <div class="ml-3">

                        <!-- Heading -->
                        <h4 class="font-weight-normal mb-1">{{pool.stablecoinSymbol}}</h4>

                        <!-- Text -->
                        <small class="text-muted">{{pool.protocol}}</small>

                      </div>
                    </div>
                  </td>
                  <td>
                    <h4 class="mb-1 glowing">${{pool.totalUserDepositsUSD.toFormat(DECIMALS)}}</h4>
                    <span class="text-white">{{pool.totalUserDeposits.toFormat(DECIMALS)}} {{pool.stablecoinSymbol}}</span>
                  </td>
                  <td>
                    <span class="h4 mb-0 glowing">Up to {{pool.oneYearInterestRate.toFormat(DECIMALS)}}%</span>
                    <span  class="badge badge-dark border border-light py-0 pl-0 mt-n2 ml-2" style="
                    border-radius: 14px;" placement="top"
                    ngbTooltip="Deposits with custom maturity get rewarded with vested MPH tokens that can be staked to earn rewards (protocol fees, harvested tokens, etc)">
                      <div class="avatar avatar-xs">
                        <img src="./assets/img/token-icons/mph-logo-24.svg" width="16" alt="..." class="avatar-img rounded-circle">
                      </div>
                      +{{pool.mphAPY.toFormat(DECIMALS)}}% APR
                    </span>
                  </td>
                  <td class="text-right">
                    <!-- Button -->
                    <!-- <button type="button" class="btn btn-sm btn-bg-gradient mr-3" (click)="openDepositModal(pool.name)" [disabled]="wallet.watching"> -->
                    <button type="button" class="btn btn-sm btn-bg-gradient mr-3" (click)="openDepositModal(pool.name)">
                      <i class="fe fe-arrow-down mr-2 align-bottom"></i>Deposit
                    </button>
                    <button class="btn btn-sm btn-dark btn-rounded-circle" type="button" data-toggle="collapse" [attr.data-target]="'#' + pool.name" aria-expanded="false" [attr.aria-controls]="pool.name">
                      <i class="fe fe-chevron-down"></i>
                    </button>
                  </td>
                </tr>

                <!-- Deposit rows -->
                <ng-container *ngFor="let userPool of userPools">
                  <ng-container *ngIf="userPool.poolInfo.name===pool.name">
                    <ng-container *ngFor="let deposit of userPool.deposits">
                      <tr class="multi-collapse collapse show" id={{userPool.poolInfo.name}}>
                        <td>
                          <div class="d-flex align-items-center">
                            <div>
                              <h6 class="text-muted text-uppercase mb-1">Custom maturity</h6>
                              <!-- badge -->
                              <span class="badge mb-1 badge-soft-danger">
                                  Locked
                              </span>

                              <!-- Text -->
                              <small class="text-muted d-block">{{deposit.countdownTimer.days}}d
                                {{deposit.countdownTimer.hours}}h {{deposit.countdownTimer.minutes}}m
                                {{deposit.countdownTimer.seconds}}s</small>
                            </div>
                          </div>
                        </td>
                        <td>
                          <h4 class="mb-1 font-weight-bold glowing">${{deposit.amountUSD.toFormat(DECIMALS)}}</h4>
                          <div class="text-muted d-block">{{deposit.amountToken.toFormat(DECIMALS)}}
                            {{userPool.poolInfo.stablecoinSymbol}}</div>
                        </td>
                        <td>
                          <h4 class="mb-1 font-weight-bold glowing">{{deposit.apy.toFormat(DECIMALS)}}% APY <span class="badge badge-dark border border-light py-0 pl-0 ml-2 mt-n1" style="
                            border-radius: 14px;" placement="top"
                            ngbTooltip="Deposits with custom maturity get rewarded with vested MPH tokens that can be staked to earn rewards (protocol fees, harvested tokens, etc)">
                              <div class="avatar avatar-xs">
                                <img src="./assets/img/token-icons/mph-logo-24.svg" width="16" alt="..." class="avatar-img rounded-circle">
                              </div>
                              +{{deposit.mphAPY.toFormat(DECIMALS)}}% APR
                            </span></h4>
                          <span class="text-muted d-block">${{deposit.interestEarnedUSD.toFormat(DECIMALS)}} / ${{deposit.realMPHReward.times(mphPriceUSD).toFormat(DECIMALS)}} ({{deposit.realMPHReward.toFormat(DECIMALS)}} MPH)
                            <button type="button" class="btn btn-sm btn-dark mr-3 text-primary" (click)="openRewardsModal(deposit)">
                              <i class="fe fe-arrow-down mr-2 align-bottom"></i>Claim
                            </button>
                          </span>
                        </td>
                        <td class="text-right">
                          <button type="button" class="btn btn-sm btn-dark mr-3"
                          (click)="openTopUpModal(deposit, userPool.poolInfo)" *ngIf="deposit.locked">
                            <i class="fe fe-arrow-down mr-2 align-bottom"></i>Top up
                          </button>
                          <button type="button" class="btn btn-sm btn-dark mr-3"
                          (click)="openRollOverModal(deposit, userPool.poolInfo)" *ngIf="deposit.locked">
                            <i class="fe fe-arrow-down mr-2 align-bottom"></i>Roll over
                          </button>
                          <button type="button" class="btn btn-sm btn-dark"
                          (click)="openWithdrawModal(deposit, userPool.poolInfo)">
                            <i class="fe fe-arrow-up mr-2 align-bottom"></i>
                            <ng-container *ngIf="deposit.locked">
                              Withdraw early
                            </ng-container>
                            <ng-container *ngIf="!deposit.locked">
                              Withdraw
                            </ng-container>
                          </button>
                        </td>
                      </tr>
                    </ng-container>
                  </ng-container>
                </ng-container>

                <!-- ZCB rows -->
                <ng-container *ngFor="let userZCBPool of userZCBPools">
                  <ng-container *ngIf="userZCBPool.poolName===pool.name">
                    <tr class="multi-collapse collapse show" id={{userZCBPool.poolName}}>
                      <td>
                        <div class="d-flex align-items-center">
                          <div>
                            <h6 class="text-muted text-uppercase mb-1">Preset maturity</h6>
                            <!-- badge -->
                            <span class="badge mb-1 badge-soft-danger">
                                Locked
                            </span>
                            <!-- Text -->
                            <small class="text-muted d-block">{{userZCBPool.maturation}}</small>
                          </div>
                        </div>
                      </td>
                      <td>
                        <h4 class="mb-1 font-weight-bold glowing">${{userZCBPool.amountUSD.toFormat(DECIMALS)}}</h4>
                        <div class="text-muted d-block">{{userZCBPool.amountToken.toFormat(DECIMALS)}} ZCB</div>
                      </td>
                      <td>
                        <h4 class="mb-1 font-weight-bold glowing">0.00% APY</h4>
                      </td>
                      <td class="text-right">
                        <button type="button" class="btn btn-sm btn-dark mr-3"
                        (click)="openTopUpModal()">
                          <i class="fe fe-arrow-down mr-2 align-bottom"></i>Top up
                        </button>
                        <button type="button" class="btn btn-sm btn-dark mr-3" routerLink="/rewards">
                          <i class="fe fe-arrow-down mr-2 align-bottom"></i>Stake
                        </button>
                        <a href="https://app.sushi.com/swap" class="btn btn-sm btn-dark">
                          <i class="fe fe-arrow-up mr-2 align-bottom"></i>
                            Sell
                        </a>
                      </td>
                    </tr>
                  </ng-container>
                </ng-container>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div> <!-- / .row -->






  <!--v2 code-->
  <div class="row d-none">
    <div class="col-12">
      <!-- Current deposits -->
      <div class="card mb-6" *ngIf="userPools.length">
        <div class="card-header">
          <h2 class="mb-0">Current deposits</h2>
        </div>
        <div class="table-responsive mb-0">
          <table class="table table-sm table-nowrap card-table">
            <thead>
              <tr>
                <th>
                  Pool
                </th>
                <th>
                  Deposits
                </th>
                <th>
                  Interest earned
                </th>
                <th>
                  MPH rewards
                </th>
              </tr>
            </thead>
            <tbody class="list">
              <ng-container *ngFor="let userPool of userPools">
                <!-- Pool row -->
                <tr>
                  <td>
                    <div class="d-flex align-items-center">

                      <!-- Image -->
                      <div class="avatar avatar-xs">
                        <img class="avatar-img rounded-circle mr-3" src={{userPool.poolInfo.iconPath}} alt="...">
                      </div>

                      <div class="ml-3">

                        <!-- Heading -->
                        <h4 class="font-weight-normal mb-1">{{userPool.poolInfo.stablecoinSymbol}}</h4>

                        <!-- Text -->
                        <small class="text-muted">{{userPool.poolInfo.protocol}}</small>

                      </div>
                    </div>
                  </td>
                  <td>
                    <!-- Button -->
                    <button type="button" class="btn btn-sm btn-bg-gradient"
                      (click)="openDepositModal(userPool.poolInfo.name)" [disabled]="wallet.watching">
                      <i class="fe fe-arrow-down mr-2 align-bottom"></i>New deposit
                    </button>
                  </td>
                  <td colspan="3"></td>
                </tr>
                <!-- Deposit rows -->
                <ng-container *ngFor="let deposit of userPool.deposits">
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">


                        <div>

                          <!-- badge -->
                          <span class="badge mb-1"
                            [ngClass]="{'badge-soft-danger': deposit.locked, 'badge-soft-success': !deposit.locked}">
                            <ng-container *ngIf="deposit.locked">
                              Locked
                            </ng-container>
                            <ng-container *ngIf="!deposit.locked">
                              Unlocked
                            </ng-container>
                          </span>

                          <!-- Text -->
                          <small class="text-white d-block">{{deposit.countdownTimer.days}}d
                            {{deposit.countdownTimer.hours}}h {{deposit.countdownTimer.minutes}}m
                            {{deposit.countdownTimer.seconds}}s</small>
                        </div>
                      </div>
                    </td>
                    <td>
                      <h4 class="mb-1 font-weight-bold glowing">${{deposit.amountUSD.toFormat(DECIMALS)}}</h4>
                      <div class="text-white d-block">{{deposit.amountToken.toFormat(DECIMALS)}}
                        {{userPool.poolInfo.stablecoinSymbol}}</div>
                    </td>
                    <td>
                      <h4 class="mb-1 font-weight-bold glowing">${{deposit.interestEarnedUSD.toFormat(DECIMALS)}}</h4>
                      <span class="text-white d-block">({{deposit.apy.toFormat(2)}}% APY)</span>
                    </td>
                    <td>
                      <span class="h4 mb-1 font-weight-bold glowing">
                        ${{deposit.realMPHReward.times(mphPriceUSD).toFormat(DECIMALS)}}</span>
                      <span  class="badge badge-dark border border-light py-0 pl-0 ml-2 mt-n1" style="
                      border-radius: 14px;" placement="top"
                      ngbTooltip="Deposits with custom maturity get rewarded with vested MPH tokens that can be staked to earn rewards (protocol fees, harvested tokens, etc)">
                        <div class="avatar avatar-xs">
                          <img src="./assets/img/token-icons/mph-logo-24.svg" width="16" alt="..." class="avatar-img rounded-circle">
                        </div>
                        +{{deposit.mphAPY.toFormat(2)}}% APR
                      </span>
                      <span class="text-white d-block">{{deposit.realMPHReward.toFormat(DECIMALS)}} MPH</span>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-bg-gradient mr-3"
                        (click)="openDepositModal(deposit, userPool.poolInfo)" [disabled]="wallet.watching">
                        <i class="fe fe-arrow-down mr-2 align-bottom"></i>Top up
                      </button>
                      <button type="button" class="btn btn-sm border-gradient"
                      (click)="openWithdrawModal(deposit, userPool.poolInfo)" [disabled]="wallet.watching">
                        <i class="fe fe-arrow-up mr-2 align-bottom"></i>
                        <ng-container *ngIf="deposit.locked">
                          Withdraw early
                        </ng-container>
                        <ng-container *ngIf="!deposit.locked">
                          Withdraw
                        </ng-container>
                      </button>
                    </td>
                  </tr>
                </ng-container>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Explore fixed rate opportunities -->
      <div class="card mb-6" id="fixedRateOpportunities">
        <div class="card-header">
          <h2 class="mb-0">Explore fixed-interest rate opportunities</h2>
        </div>
        <div class="table-responsive mb-0">
          <table class="table table-sm table-nowrap card-table">
            <thead>
              <tr>
                <th>
                  Pool
                </th>
                <th>
                  Your balance
                </th>
                <th>
                  Earn fixed APY
                </th>
                <th></th>
              </tr>
            </thead>
            <tbody class="list">
              <tr *ngFor="let pool of allPoolList">
                <td>
                  <div class="d-flex align-items-center">

                    <!-- Image -->
                    <div class="avatar avatar-xs">
                      <img class="avatar-img rounded-circle mr-3" src={{pool.iconPath}} alt="...">
                    </div>

                    <div class="ml-3">

                      <!-- Heading -->
                      <h4 class="font-weight-normal mb-1">{{pool.stablecoinSymbol}}</h4>

                      <!-- Text -->
                      <small class="text-muted">{{pool.protocol}}</small>

                    </div>
                  </div>
                </td>
                <td>
                  <h4 class="mb-1 glowing">${{pool.totalDepositUSD.toFormat(DECIMALS)}}</h4>
                  <span class="text-white">{{pool.totalDepositToken.toFormat(2)}} {{pool.stablecoinSymbol}}</span>
                </td>
                <td>
                  <span class="h4 mb-0 glowing">Up to {{pool.oneYearInterestRate.toFormat(2)}}%</span>
                  <span  class="badge badge-dark border border-light py-0 pl-0 mt-n2 ml-2" style="
                  border-radius: 14px;" placement="top"
                  ngbTooltip="Deposits with custom maturity get rewarded with vested MPH tokens that can be staked to earn rewards (protocol fees, harvested tokens, etc)">
                    <div class="avatar avatar-xs">
                      <img src="./assets/img/token-icons/mph-logo-24.svg" width="16" alt="..." class="avatar-img rounded-circle">
                    </div>
                    +{{pool.mphAPY.toFormat(2)}}%
                  </span>
                </td>
                <td>
                  <!-- Button -->
                  <button type="button" class="btn btn-bg-gradient border-0" (click)="openDepositModal(pool.name)" [disabled]="wallet.watching">
                    <i class="fe fe-arrow-down mr-2 align-bottom"></i>Deposit
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div> <!-- / .row -->
</div>
